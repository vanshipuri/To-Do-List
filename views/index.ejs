<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title><%= selectedList.name %> - To-do List</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>
  <body
    class="bg-gradient-to-br from-blue-100 to-purple-200 min-h-screen flex flex-col font-sans"
  >
    <!-- Navbar -->
    <nav class="bg-white border-gray-200 dark:bg-gray-900">
      <div
        class="flex flex-wrap justify-between items-center mx-auto max-w-screen-xl p-4"
      >
        <a href="/" class="flex items-center space-x-3 rtl:space-x-reverse">
          <img
            src="https://flowbite.com/docs/images/logo.svg"
            class="h-8"
            alt="Logo"
          />
          <span
            class="self-center text-2xl font-semibold whitespace-nowrap dark:text-white"
            >To-Do List</span
          >
        </a>

        <div class="flex items-center space-x-6 rtl:space-x-reverse">
          <% if (user) { %>
          <a href="/logout" class="text-sm text-red-600 hover:underline"
            >Logout</a
          >
          <% } else { %>
          <a href="/login" class="text-sm text-blue-600 hover:underline"
            >Login</a
          >
          <% } %>
        </div>
      </div>
    </nav>

    <!-- Task List -->
    <div
      class="w-full max-w-3xl mx-auto bg-white rounded-2xl shadow-lg p-6 space-y-6 mt-6"
    >
      <!-- üîó List Selector Nav -->

      <nav class="bg-gray-100 rounded-xl px-4 py-3 my-6">
        <ul
          class="flex flex-wrap justify-left font-medium gap-6 text-sm text-gray-700 w-full"
        >
          <% allLists.forEach(function(list) { %>
          <li class="flex items-center gap-2">
            <a
              href="/lists/<%= list.id %>"
              class="<%= list.id === selectedList.id ? 'text-white bg-indigo-700 px-2 py-1 ml-auto rounded-lg' : 'text-gray-600 hover:text-indigo-600' %>"
            >
              <%= list.name %>
            </a>
          </li>
          <% }) %>

          <!-- ‚úÖ Add New List Form -->
          <li class="ml-auto">
            <form
              action="/lists/create"
              method="POST"
              class="flex items-center gap-2"
            >
              <input
                type="text"
                name="newList"
                placeholder="New List"
                required
                class="px-2 py-1 rounded-lg border border-gray-300 text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500"
              />
              <button
                type="submit"
                class="bg-indigo-900 text-white px-3 py-1 rounded-lg text-sm hover:bg-indigo-700 transition"
              >
                ‚ûï
              </button>
            </form>
          </li>
        </ul>
      </nav>

      <!-- Title -->
      <div class="mt-6">
        <h2 class="text-center text-3xl font-bold text-gray-800 mb-4">
          <%= selectedList.name %> To-do 
         <form action="/lists/delete-list/<%= selectedList.id %>" method="POST"onsubmit="return confirm('Are you sure you want to delete this list?')">
            <button
              type="submit"
              class="bg-red-200 text-black px-3 py-1.5 rounded-lg hover:bg-red-400"
            >
              üóëÔ∏è
            </button>
          </form>
        </h2>
        
      </div>

      <div
        class="flex flex-col md:flex-row items-center justify-center gap-6 p-4 flex-wrap"
      >
        <!-- üìù Add Task Form -->
        <form
          action="/lists/add/<%= selectedList.id %>"
          method="POST"
          class="flex gap-2 w-full md:max-w-lg shadow"
        >
          <input
            type="text"
            name="todo"
            placeholder="Add your task..."
            required
            autofocus
            class="w-full px-4 py-2 rounded-lg border border-gray-300 focus:outline-none focus:ring-2 focus:ring-indigo-400"
          />
          <button
            type="submit"
            class="bg-indigo-900 text-white px-4 py-2 rounded-lg hover:bg-indigo-700"
          >
            ‚ûï
          </button>
        </form>
      </div>

      <ul class="space-y-3">
        <% tasks.forEach(function(task) { %>
        <li class="flex justify-between items-center border-b pb-2">
          <!-- üîò Checkbox and Task Name -->
          <form
            action="/lists/<%= task.completed ? 'incomplete' : 'complete' %>/<%= selectedList.id %>"
            method="POST"
            id="form-<%= task.id %>"
            class="flex items-center gap-3"
          >
            <input type="hidden" name="taskId" value="<%= task.id %>" />

            <input id="checkbox-<%= task.id %>" type="checkbox" <%=
            task.completed ? 'checked' : '' %>
            onchange="document.getElementById('form-<%= task.id %>').submit()"
            class="w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded-sm
            focus:ring-blue-500" />

            <label
              for="checkbox-<%= task.id %>"
              class="text-sm font-medium <%= task.completed ? 'text-gray-400 line-through' : 'text-gray-900' %> cursor-pointer"
            >
              <%= task.text %>
            </label>
          </form>

          <!-- üóëÔ∏è Delete Button -->
          <form action="/lists/delete/<%= selectedList.id %>" method="POST">
            <input type="hidden" name="taskId" value="<%= task.id %>" />
            <button
              type="submit"
              class="bg-red-200 text-black px-3 py-1.5 rounded-lg hover:bg-red-400"
            >
              üóëÔ∏è
            </button>
          </form>
        </li>
        <% }) %>
      </ul>
    </div>

    <!-- Footer -->
    <footer
      class="mt-auto bg-white shadow-inner text-center text-gray-600 py-4 text-sm"
    >
      <%- include('partials/footer'); %>
    </footer>
  </body>
</html>
